<html>
<!-- SEE EXAMPLE TEMPLATES HERE: /Users/vcrocla/src/dynamide/build/resource_root/homes/dynamide/assemblies/com-dynamide-apps-1/apps/us.anarchia.admin/resources/static/reorderStory.html
-->
<head>
    <script src="js/handlebars-v3.0.0.js"></script>
    <script src="js/jquery-2.1.3.min.js"></script>
    <link  href="js/jquery-ui/themes/base/jquery-ui.css" rel="stylesheet" type="text/css"/>
    <script src="js/jquery-ui/ui/minified/jquery-ui.min.js"></script>
    <script src="js/jquery-ui-touch-punch.js"></script>
    <link  href="css/anarchia.css" rel="stylesheet" type="text/css"/>
    
    <style type="">
    body {
        background-color: white;
        color: green;
    }
    </style>
</head>
<body>


<input type="text" id="editAuthor" value="LaramieAuthor"/><button id="btnGetByAuthor">Get by Author</button>

<div id='filesDiv'></div>

<script id="TemplateSource" type="text/x-handlebars-template">
    <table border='1' cellpadding='2' cellspacing='0' width="100%">
        <tr style='background-color: lightgray;'><th><input type='checkbox' name='' id='' /></th><th>img</th><th>filename</th><th>Author</th><th>title</th><th>caption</th></tr>
        {{#each filesArray}}
            <tr>
                <th>
                    <input type='checkbox' name='' id='' />
                </th>
                <th>
                    <a href='/anarchia-admin?page=addImage&action=getimage&filename={{filename}}' target='_blank' ><img width='100px' src='/anarchia-admin?page=addImage&action=getimage&filename={{filename}}' /></a>
                </th>
                <th>{{filename}}</th>
                <th class=''>{{metadata.author}}</th>
                <th class=''>{{metadata.title}}</th>
                <th class=''>{{metadata.caption}}</th>
            </tr>
        {{/each}}
    </table>
</script>

</body>
<script>
    var gFiles = null;
    var source = document.getElementById('TemplateSource').innerHTML
    var templateFn = Handlebars.compile(source);
        
    function renderTemplate(data){
        if (data){
            $('#filesDiv').html(templateFn({filesArray: data}));
        }
    }
    
    function getByAuthor(author){
        // AJAX CALL HERE :
       $.get('/anarchia-admin?page=addImage&action=getimages&author='+author,
          function(data) {
              if (data.files){
                  gFiles = data.files;
                  console.log('files: '+JSON.stringify(gFiles));
                  renderTemplate(gFiles);
              }
          }
       );
    }
    
    function documentReady(){
        $( "#btnGetByAuthor" ).click(function() {
            getByAuthor($( "#editAuthor" ).val());
        });
    }

    $(document).ready(documentReady);
    
</script>
</html>

